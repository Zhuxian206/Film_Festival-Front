(function(e){function t(t){for(var r,i,u=t[0],s=t[1],c=t[2],l=0,d=[];l<u.length;l++)i=u[l],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);m&&m(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(r=!1)}r&&(o.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},a={app:0},o=[];function i(e){return u.p+"js/"+({admin:"admin",login:"login",movie:"movie",movies:"movies",new:"new",news:"news",questions:"questions",register:"register",screenings:"screenings",user:"user"}[e]||e)+"."+{admin:"0591f702",login:"0536cca7",movie:"3b965a90",movies:"733864d7",new:"4c843e9f",news:"b5df7883",questions:"af689cd3",register:"295113fa",screenings:"318428fc",user:"f7d8887a"}[e]+".js"}function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=a[e]=[t,r]}));t.push(n[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,u.nc&&s.setAttribute("nonce",u.nc),s.src=i(e);var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",c.name="ChunkLoadError",c.type=r,c.request=o,n[1](c)}a[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="",u.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var m=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"27dc":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"login",(function(){return C})),n.d(r,"logout",(function(){return A})),n.d(r,"getInfo",(function(){return R}));var a={};n.r(a),n.d(a,"user",(function(){return L}));var o={};n.r(o),n.d(o,"login",(function(){return $})),n.d(o,"logout",(function(){return q})),n.d(o,"getInfo",(function(){return I})),n.d(o,"extend",(function(){return M}));n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("e792"),n("0cdd");var i=n("2b0e"),u=n("b1e0"),s=n("5f5b");n("ab8b"),n("2dd8");i["default"].use(u["a"]),i["default"].use(s["a"]);n("d3b7"),n("caad"),n("2532");var c=n("bc3a"),l=n.n(c),m=n("130e"),d=n("3d20"),p=n.n(d),f=n("2f62"),h=function(){return{token:"",account:"",role:0,email:"",cart:0,realName:"",cellPhone:""}},v=n("1da1"),g=(n("96cf"),n("3ca3"),n("ddb0"),n("8c4f")),b=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"home"}},[r("video",{staticClass:"w-100",attrs:{autoplay:"",muted:"",loop:""},domProps:{muted:!0}},[r("source",{attrs:{src:n("e9b4"),type:"video/mp4"}})]),e._m(0),r("div",{staticClass:"container"},[r("h2",{staticClass:"home_title"},[e._v("最新消息")]),r("hr"),r("b-row",e._l(e.news,(function(e){return r("b-col",{key:e._id,attrs:{cols:"12",md:"6",to:"/neww/"+e._id}})})),1),r("h2",{staticClass:"home_title"},[e._v("新片推薦")]),r("hr")],1),r("div",{staticClass:"row p-3"},e._l(e.movies,(function(t,n){return r("b-col",{key:t._id,staticClass:"p-0",attrs:{cols:"12",md:"6",to:"/movie/"+t._id}},[r("b-card",{staticClass:"card-st",attrs:{overlay:"","img-src":t.image,"img-alt":"Card Image","text-variant":"white",title:t.name,"sub-title":t.director,to:"/movie/"+t._id}},[r("router-link",{attrs:{to:"/movie/"+t._id}},[e._v("查看詳情")])],1)],1)})),1)])},w=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"toptittle"},[n("p",[e._v("天")]),n("p",[e._v("空")]),n("p",[e._v("影")]),n("p",[e._v("展")])])}],_={data:function(){return{movies:[],news:[]}},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.api.get("/movies");case 3:n=t.sent,r=n.data,e.movies=r.result,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"片單取得失敗"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}},x=_,k=n("2877"),y=Object(k["a"])(x,b,w,!1,null,null,null),P=y.exports;i["default"].use(g["a"]);var O=[{path:"/",name:"Home",component:P,meta:{title:"天空影展"}},{path:"/moviesPage",name:"MoviesPage",component:function(){return n.e("movies").then(n.bind(null,"280c"))},meta:{title:"節目資訊 | 天空影展"}},{path:"/movie/:id",name:"Movie",component:function(){return n.e("movie").then(n.bind(null,"def6"))},meta:{title:"影片內容 | 天空影展"}},{path:"/screenings",name:"Screenings",component:function(){return n.e("screenings").then(n.bind(null,"279d"))},meta:{title:"本季場次 | 天空影展"}},{path:"/questions",name:"Questions",component:function(){return n.e("questions").then(n.bind(null,"66ba"))},meta:{title:"常見問題 | 天空影展"}},{path:"/newsPage",name:"NewsPage",component:function(){return n.e("news").then(n.bind(null,"013c"))},meta:{title:"最新消息 | 天空影展"},children:[{path:"",name:"NewsHome",component:function(){return n.e("news").then(n.bind(null,"fcd2"))},meta:{title:"消息中心 | 天空影展"}},{path:"all",name:"NewsAll",component:function(){return n.e("news").then(n.bind(null,"1365"))},meta:{title:"新聞 | 天空影展"}},{path:"news",name:"NewsNews",component:function(){return n.e("news").then(n.bind(null,"9f83"))},meta:{title:"新聞 | 天空影展"}},{path:"announcement",name:"NewsAnnouncement",component:function(){return n.e("news").then(n.bind(null,"a2e0"))},meta:{title:"公告 | 天空影展"}},{path:"promote",name:"NewsPromote",component:function(){return n.e("news").then(n.bind(null,"3dd4"))},meta:{title:"推廣 | 天空影展"}},{path:"other",name:"NewsOther",component:function(){return n.e("news").then(n.bind(null,"fa20"))},meta:{title:"其他 | 天空影展"}}]},{path:"/new/:id",name:"New",component:function(){return n.e("new").then(n.bind(null,"67bf"))},meta:{title:"消息內容 | 天空影展"}},{path:"/register",name:"Register",component:function(){return n.e("register").then(n.bind(null,"73cf"))},meta:{title:"註冊 | 天空影展"}},{path:"/login",name:"Login",component:function(){return n.e("login").then(n.bind(null,"a55b"))},meta:{title:"登入 | 天空影展"}},{path:"/admin",name:"Admin",component:function(){return n.e("admin").then(n.bind(null,"3530"))},children:[{path:"",name:"AdminHome",component:function(){return n.e("admin").then(n.bind(null,"c732"))},meta:{login:!0,admin:!0,title:"管理中心 | 天空影展"}},{path:"movies",name:"AdminMovies",component:function(){return n.e("admin").then(n.bind(null,"f3d7"))},meta:{login:!0,admin:!0,title:"片單管理 | 天空影展"}},{path:"news",name:"AdminNews",component:function(){return n.e("admin").then(n.bind(null,"afb5"))},meta:{login:!0,admin:!0,title:"消息管理 | 天空影展"}},{path:"orders",name:"AdminOrders",component:function(){return n.e("admin").then(n.bind(null,"ec5c"))},meta:{login:!0,admin:!0,title:"訂單管理 | 天空影展"}}]},{path:"/user",name:"User",component:function(){return n.e("user").then(n.bind(null,"1511"))},children:[{path:"",name:"UserHome",component:function(){return n.e("user").then(n.bind(null,"99ca"))},meta:{login:!0,admin:!1,title:"會員中心 | 天空影展"}},{path:"data",name:"UserData",component:function(){return n.e("user").then(n.bind(null,"922f"))},meta:{login:!0,admin:!1,title:"會員資料 | 天空影展"}},{path:"order",name:"UserOrder",component:function(){return n.e("user").then(n.bind(null,"0435"))},meta:{login:!0,admin:!1,title:"歷史訂單 | 天空影展"}}]},{path:"*",name:"NotFound",redirect:"/"}],j=new g["a"]({routes:O});j.beforeEach((function(e,t,n){var r=B.getters["user/user"];e.meta.login&&!r.isLogin?n("/login"):e.meta.admin&&!r.isAdmin?n("/"):n()})),j.afterEach((function(e,t){document.title=e.meta.title}));var N=j,C=function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t,n){var r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,e.prev=1,e.next=4,U.post("/users/login",n);case 4:a=e.sent,o=a.data,r("login",o.result),N.push("/"),p.a.fire({icon:"success",title:"成功",text:"登入成功"}),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),p.a.fire({icon:"error",title:"失敗",text:e.t0.response.data.message});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,r=t.state,e.prev=1,e.next=4,U.delete("/users/logout",{headers:{authorization:"Bearer "+r.token}});case 4:n("logout"),N.push("/"),p.a.fire({icon:"success",title:"成功",text:"登出成功"}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),p.a.fire({icon:"error",title:"失敗",text:e.t0.response.data.message});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t){var n,r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.commit,r=t.state,0!==r.token.length){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,U.get("/users/me",{headers:{authorization:"Bearer "+r.token}});case 6:a=e.sent,o=a.data,n("getInfo",o.result),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](3),n("logout");case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}(),E=n("5530"),L=function(e){return Object(E["a"])({isLogin:e.token.length>0,isAdmin:1===e.role},e)},$=function(e,t){e.token=t.token,e.account=t.account,e.role=t.role,e.email=t.email,e.cart=t.cart,e.realName=t.realName,e.cellPhone=t.cellPhone},q=function(e,t){e.token="",e.account="",e.role=0,e.email="",e.cart=0,e.realName="",e.cellPhone=""},I=function(e,t){e.account=t.account,e.role=t.role,e.email=t.email,e.cart=t.cart,e.realName=t.realName,e.cellPhone=t.cellPhone},M=function(e,t){e.token=t},S={namespaced:!0,state:h,actions:r,getters:a,mutations:o},T=n("0e44");i["default"].use(f["a"]);var B=new f["a"].Store({state:{},mutations:{},actions:{},modules:{user:S},plugins:[Object(T["a"])({key:"film",paths:["user.token"]})]}),U=l.a.create({baseURL:""});U.interceptors.response.use((function(e){return e}),(function(e){if(e.response){if(401===e.response.status&&"/users/extend"!==e.config.url){var t=e.config;return U.post("/users/extend",{},{headers:{authorization:"Bearer "+B.state.user.token}}).then((function(e){var n=e.data;return B.commit("user/extend",n.result.token),t.headers.authorization="Bearer "+B.state.user.token,l()(t)})).catch((function(e){return B.commit("user/logout"),N.push("/login"),Promise.reject(e)}))}}else"ECONNABORTED"===e.code&&e.message.includes("timeout")?p.a.fire({icon:"error",title:"錯誤",text:"請求逾時"}):p.a.fire({icon:"error",title:"錯誤",text:"網路不穩定"});return Promise.reject(e)})),i["default"].use(m["a"],{axios:l.a,api:U});var z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"dark"}},[n("b-navbar-brand",{attrs:{to:"/"}},[e._v("天空影展")]),n("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-item",{attrs:{to:"/#"}},[e._v("關於影展")]),n("b-nav-item",{attrs:{to:"/moviesPage"}},[e._v("片單欣賞")]),n("b-nav-item",{attrs:{to:"/screenings"}},[e._v("時間場次")]),n("b-nav-item",{attrs:{to:"/questions"}},[e._v("常見問題")]),n("b-nav-item",{attrs:{to:"/newsPage"}},[e._v("最新消息")]),e.user.isLogin?e._e():n("b-nav-item",{attrs:{to:"/register"}},[e._v("註冊")]),e.user.isLogin?e._e():n("b-nav-item",{attrs:{to:"/login"}},[e._v("登入")]),e.user.isLogin?n("b-nav-item",{on:{click:e.logout}},[e._v("登出")]):e._e(),e.user.isLogin&&e.user.isAdmin?n("b-nav-item",{attrs:{to:"/admin"}},[e._v("管理中心")]):e._e(),e.user.isLogin&&!e.user.isAdmin?n("b-nav-item",{attrs:{to:"/user"}},[e._v("會員中心")]):e._e()],1)],1)],1),n("router-view",{key:e.$route.fullPath}),e._m(0)],1)},H=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main_footer w-100 p-5"},[n("p",[e._v("影展資訊")])])}],D={methods:{logout:function(){this.$store.dispatch("user/logout")}},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.dispatch("user/getInfo");case 1:case"end":return t.stop()}}),t)})))()}},J=D,F=Object(k["a"])(J,z,H,!1,null,null,null),Q=F.exports,G=n("f9d5"),K=n.n(G),V=(n("4413"),{computed:{user:function(){return this.$store.getters["user/user"]}}}),W=(n("27dc"),n("657c"));n("2bd9");i["default"].use(K.a),i["default"].config.productionTip=!1,i["default"].mixin(V),i["default"].component("ImgInputer",W["a"]),new i["default"]({router:N,store:B,render:function(e){return e(Q)}}).$mount("#app")},e9b4:function(e,t,n){e.exports=n.p+"media/pexels-naga-sumanth-l-5512078.7ed8012c.mp4"}});
//# sourceMappingURL=app.3f83c641.js.map